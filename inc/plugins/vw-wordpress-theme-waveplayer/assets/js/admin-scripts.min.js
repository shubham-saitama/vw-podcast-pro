!function(e,t){"use strict";document.addEventListener("vwwaveplayer.engine.ready",(a=>{const l=a.detail.engine;l.setOption("autoplay",!1);var o,r;e(document).on("click","#woocommerce-product-data .preview_files a.insert",(function(){return e(this).closest(".preview_files").find("tbody").append(e(this).data("row")),!1})),e(document).on("click","#woocommerce-product-data .preview_files a.delete",(function(){return e(this).closest("tr").remove(),!1})),e(".preview_files tbody").sortable({items:"tr",cursor:"move",axis:"y",handle:"td.sort",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65}),e(document).on("click",".upload_preview_button",(function(t){var a=e(this);if(r=a.closest("tr").find("td.file_url input"),t.preventDefault(),o)o.open();else{var l=[new wp.media.controller.Library({library:wp.media.query({type:"audio"}),multiple:!0,title:a.data("choose"),priority:20,filterable:"all"})];(o=wp.media.frames.preview_file=wp.media({title:a.data("choose"),library:{type:"audio"},button:{text:a.data("update")},multiple:!0,states:l})).on("select",(function(){var e="";o.state().get("selection").map((function(t){(t=t.toJSON()).url&&(e=t.url)})),r.val(e).change()})),o.on("ready",(function(){o.uploader.options.uploader.params={type:"download_preview"}})),o.open()}})),document.location.href.includes("page=vwwaveplayer")&&(()=>{const a=l.vars.options.override_wave_colors;let o;iro.use(iroTransparencyPlugin);const r=function(t=!0){o=null,e("#color-picker").remove(),e("#color-picker-container").append(e("<div>",{id:"color-picker"})),o=new iro.ColorPicker("#color-picker",{width:120,color:"rgb(255, 0, 0)",borderWidth:1,handleRadius:5,sliderHeight:20,sliderMargin:10,borderColor:"#000",transparency:t}),o.on(["color:change"],(function(t){let a=document.querySelector(".color-swatch.current");if(!a)return;const l=v(t.hex8String);if(a.classList.contains("palette-swatch")){const l=e(a).index(),o=e("#palette").attr("data-colors").split("-");o[l]=t.hexString.replace("#",""),a.dataset.color=Object.values(t.rgb).join(","),a.dataset.hue=t.hsl.h,i(o)}else{const e=a.nextElementSibling;e&&(e.value=l),a.style.backgroundColor=l;const t=a.dataset.name.replace("vwwaveplayer_","");vwwvplVars.options[t]=l,d()}e("#color-picker-value").val(l).select().focus()}))};if(document.location.search.includes("page=vwwaveplayer")){const t=e("#vwwaveplayer_current_tab").val();"waveform"===t?(r(),l.vars.options.override_wave_colors=!1):"palettes"===t&&(r(!1),l.vars.options.override_wave_colors=a),window.history.replaceState({page:"vwwaveplayer",tab:t},e(`#vwwaveplayer-${t} h2`).text()+" ‹ VwWavePlayer Settings",`${document.location.pathname}?page=vwwaveplayer&tab=${t}`),e("input[name=_wp_http_referer]").val(e("input[name=_wp_http_referer]").val().replace(/\&tab=(.*)/,`&tab=${t}`));let o=0;const n=e("#vwwaveplayer-palettes").is(":visible");e("#vwwaveplayer-palettes").show(),e(".vwwvpl-palette-selectbox ul").show(),e(".vwwvpl-palette-selectbox li.vwwvpl-palette-item").each(((t,a)=>{const l=e(a).find(".vwwvpl-palette-item-name").get(0);l&&"SPAN"===l.tagName&&(o=Math.max(o,125+Number(getComputedStyle(l).getPropertyValue("width").replace("px",""))))})),e(".vwwvpl-palette-selectbox ul").hide(),e("#vwwaveplayer-palettes").toggle(n),e(".vwwvpl-palette-selectbox>div.vwwvpl-palette-item").css({width:o})}window.onpopstate=e=>{},wp.codeEditor.initialize(e("#vwwaveplayer_custom_css"),wvplCM.css),wp.codeEditor.initialize(e("#vwwaveplayer_custom_js"),wvplCM.js),e(document).on("click","#vwwaveplayer_register_license",(a=>{e("#vwwaveplayer_unregister_license + div.notice").remove();const o=e("<p>"),r=e("<div>",{class:"notice"}).append(o);if(e("#vwwaveplayer_register_license").prop("disabled",!0).addClass("in-progress"),e("input[name=vwwaveplayer_purchase_code]").prop("disabled",!0),!e("input[name=vwwaveplayer_purchase_code]").val())return e("#vwwaveplayer_unregister_license").after(r),r.addClass("update-message notice-error"),o.html(t("The purchase code cannot be empty","vwwaveplayer")),e("#vwwaveplayer_register_license").removeClass("in-progress").prop("disabled",!1),e("input[name=vwwaveplayer_purchase_code]").prop("disabled",!1),!1;const n={code:e("input[name=vwwaveplayer_purchase_code]").val(),optin:e("input#vwwaveplayer_email_optin:checked").length,nonce:l.vars.admin_tools_nonce};l.ajaxCall("register_purchase_code",n).then((t=>{const a=e("<p>"),l=e("<div>",{class:"notice"}).append(a);e("#vwwaveplayer_register_license").removeClass("in-progress").prop("disabled",!1),e("#vwwaveplayer_unregister_license").after(l),t.success?(l.addClass("updated-message notice-success"),e("#vwwaveplayer_register_license").hide(),e("span.vwwaveplayer-register-description-block").hide(),e("#vwwaveplayer_unregister_license").show(),e("span.vwwaveplayer-unregister-description-block").show()):(e("input[name=vwwaveplayer_purchase_code]").prop("disabled",!1),l.addClass("update-message notice-error")),a.html(t.data.message)}))})),e(document).on("click","#vwwaveplayer_unregister_license",(t=>{e("#vwwaveplayer_unregister_license").prop("disabled",!0).addClass("in-progress"),e("#vwwaveplayer_unregister_license + div.notice").remove();const a={code:e("input[name=vwwaveplayer_purchase_code]").val(),nonce:l.vars.admin_tools_nonce};l.ajaxCall("unregister_purchase_code",a).then((t=>{const a=e("<p>"),l=e("<div>",{class:"notice"}).append(a);e("#vwwaveplayer_unregister_license").removeClass("in-progress").prop("disabled",!1).after(l),t.success?(l.addClass("updated-message notice-success"),e("#vwwaveplayer_unregister_license").hide(),e("span.vwwaveplayer-unregister-description-block").hide(),e("#vwwaveplayer_register_license").show(),e("span.vwwaveplayer-register-description-block").show(),e("input[name=vwwaveplayer_purchase_code]").prop("disabled",!1)):l.addClass("update-message notice-error"),a.html(t.data.message)}))}));const n=[{var:"fc",s:20,l:10,a:1},{var:"fc-s",s:25,l:25,a:1},{var:"bc",s:20,l:90,a:1},{var:"bc-s",s:25,l:75,a:1},{var:"hc",s:30,l:40,a:1},{var:"hc-s",s:35,l:60,a:1},{var:"wc",s:70,l:40,a:1},{var:"wc-s",s:70,l:60,a:1},{var:"pc",s:60,l:25,a:1},{var:"pc-s",s:60,l:75,a:1},{var:"cc",s:60,l:40,a:1},{var:"cc-s",s:60,l:60,a:1}],i=function(t){e("#player_examples").css({"--poster-image":l});l.getColorStyleFromPalette(t);e("#palette").attr("data-colors",t.join("-"));for(let a=n.length-1;a>=0;a--){const l=new iro.Color(`#${t[a]}`),o=Object.values(l.rgb).join(",");if(e("#palette").get(0).style.setProperty(`--${n[a].var}`,o),e(".palette-swatch").eq(a).attr("data-color",o).attr("data-hue",l.hsl.h),a<n.length-1){const t=e(".palette-swatch").eq(a+1).attr("data-hue");e(".palette-swatch").eq(a).toggleClass("linked",Math.abs(Number(t)-l.hsl.h)<5)}e("#player_examples .vwwaveplayer").each(((e,t)=>{t.style.setProperty(`--${n[a].var}`,o)}))}};e("li.vwwvpl-palette-item.selected").length&&i(e("li.vwwvpl-palette-item.selected").attr("data-colors").split("-")),e(document).on("click","button#vwwaveplayer_random_palette",(t=>{!function(t=!0,a=!0){const l=Math.round(n.length/2);let o=3600*Math.random()/10,r=[];for(let i=0;i<l;i++){for(let t=0;t<2;t++){const l=2*i+t;let{s:s,l:c,a:p}=n[l];s=Math.max(0,Math.min(100,s+10*(1-2*Math.random()))),c=Math.max(0,Math.min(100,c+5*(1-2*Math.random()))),p*=1;const d=new iro.Color({h:o,s:s,l:c,a:p});r.push(d.hexString.slice(1)),a||(o=3600*Math.random()/10);const u=Object.values(d.rgb).join(",");e(`#palette>div:eq(${n[l].var})`).attr("data-color",u).attr("data-hue",d.hsl.h)}t||(o=3600*Math.random()/10)}e("#palette").attr("data-index",""),i(r)}(e("input#vwwaveplayer_monochromatic_palette:checked").length>0,e("input#vwwaveplayer_monochromatic_pairs:checked").length>0);e("#vwwaveplayer-palettes .vwwaveplayer").vwwaveplayer("refresh"),e("#vwwaveplayer_save_palette").prop("disabled",!1),e("input[name=vwwaveplayer_palette_name]").val("")}));var s;e(document).on("click","button#vwwaveplayer_save_palette",(t=>{t.preventDefault();e(t.target);const a={index:e("#palette").attr("data-index"),name:e("input[name=vwwaveplayer_palette_name]").val(),colors:e("#palette").attr("data-colors"),nonce:vwwvplVars.admin_tools_nonce};l.ajaxCall("save_palette",a).then((t=>{t.success&&(e("#palette").attr("data-index",t.data.index),((t,a,l,o)=>{const r=l.split("-").map((e=>`#${e}`)),n=e("<li>",{class:"vwwvpl-palette-item"}).attr("data-id",t).attr("data-colors",l);n.append(e("<span>",{class:"vwwvpl-palette-item-name"}).text(a));for(const t of r)n.append(e("<span>",{class:"vwwvpl-palette-item-swatch"}).css("background-color",t));o>=e(".vwwvpl-palette-selectbox ul li").length?(e(".vwwvpl-palette-selectbox ul li").removeClass("selected"),n.addClass("selected"),e(".vwwvpl-palette-selectbox ul").append(n)):e(".vwwvpl-palette-selectbox ul li").eq(o).html(n.html()).addClass("selected"),e(".vwwvpl-palette-selectbox>div.vwwvpl-palette-item").html(n.html())})(t.data.id,e("input[name=vwwaveplayer_palette_name]").val(),e("#palette").attr("data-colors"),t.data.index),e("#vwwaveplayer_save_palette").prop("disabled",!0))}))})),e(document).on("change","input#vwwaveplayer_monochromatic_palette",(t=>{const a=e("input#vwwaveplayer_monochromatic_palette:checked").length>0;e("button#vwwaveplayer_random_palette").click(),e("#palette>div.palette-swatch-shade").toggleClass("linked",a)})),e(document).on("change","input#vwwaveplayer_monochromatic_pairs",(t=>{const a=e("input#vwwaveplayer_monochromatic_pairs:checked").length>0;e("input#vwwaveplayer_monochromatic_palette").prop("disabled",!a),a||e("input#vwwaveplayer_monochromatic_palette").prop("checked",!1),e("#palette>div.palette-swatch-main").toggleClass("linked",a),e("button#vwwaveplayer_random_palette").click()})),e(document).on("change","input[name=vwwaveplayer_player_background_image]",(t=>{e("#player_examples .vwwaveplayer").toggleClass("vwwvpl-exhibition-mode",e(t.target).prop("checked")),e("#player_examples .vwwaveplayer").toggleClass("vwwvpl-exhibition-mode",e(t.target).prop("checked"))})),e(document).on("change","input[name=vwwaveplayer_override_wave_colors]",(t=>{l.vars.options.override_wave_colors=!!e("input[name=vwwaveplayer_override_wave_colors]:checked").length,e("#vwwaveplayer-palettes .vwwaveplayer").vwwaveplayer("refresh")})),e(document).on("click",".vwwvpl-palette-selectbox",(t=>{if(e(t.target).closest("li.vwwvpl-palette-item").length)return!1;e(t.currentTarget).focus(),e(t.currentTarget).find("ul").toggle()})),e(document).on("click",(t=>{if(e(t.target).closest(".vwwvpl-palette-selectbox").length)return!1;e(".vwwvpl-palette-selectbox").blur(),e(".vwwvpl-palette-selectbox").find("ul").hide()})),e(document).on("click",".vwwvpl-palette-selectbox ul li.vwwvpl-palette-item",(t=>{const a=e(t.currentTarget).index(),l=e(t.currentTarget).attr("data-colors");e("input[name=vwwaveplayer_default_palette]").val(l),e(".vwwvpl-palette-selectbox ul li.vwwvpl-palette-item").removeClass("selected"),e(".vwwvpl-palette-selectbox > div.vwwvpl-palette-item").html(e(t.currentTarget).html()),e(t.currentTarget).addClass("selected").closest("ul").hide(),e("#palette").attr("data-index",a),e("#vwwaveplayer_save_palette").prop("disabled",!1),e("input[name=vwwaveplayer_palette_name]").val(e(t.currentTarget).text().trim()),i(l.split("-"))})),e(document).on("click",".media-frame a.play-button",(function(t){t.preventDefault();var a=e(this).data("id"),l=e(".media-frame audio#"+a)[0];return e(".media-frame audio[id!="+a+"]").each((function(t,a){e(a)[0].pause(),e(a)[0].currentTime=0})),l.paused?l.play():l.pause(),t.stopPropagation(),!1})),e(document).on("change","select[name=vwwaveplayer_skin]",(function(t){const a=e(this).find("option:selected").data("support").split(",");e("tr[data-option=size]").toggle(a.includes("size")),e("tr[data-option=shape]").toggle(a.includes("shape")),e("tr[data-option=info]").toggle(a.includes("playlist"))})),e(document).on("click",".woocommerce-music-type .woocommerce-option",(function(e){})),e(document).on("click",".vwwaveplayer_tab",(t=>{t.preventDefault(),l.stop();const o=e(t.target).attr("href").replace("#","");"waveform_options"===o?(r(),l.vars.options.override_wave_colors=!1):"palettes"===o&&(r(!1),l.vars.options.override_wave_colors=a),l.stop(),e(".vwwaveplayer_tab").removeClass("nav-tab-active"),e(t.target).addClass("nav-tab-active"),e(".vwwaveplayer-option-page:visible").hide(),e(`#vwwaveplayer-${o}`).show(),e(".CodeMirror").each((function(e,t){t.CodeMirror.refresh()})),e("#vwwaveplayer_current_tab").val(o),window.history.replaceState({page:"vwwaveplayer",tab:o},e(`#vwwaveplayer-${o} h2`).text()+" ‹ VwWavePlayer Settings",`${document.location.pathname}?page=vwwaveplayer&tab=${o}`),e("input[name=_wp_http_referer]").val(e("input[name=_wp_http_referer]").val().replace(/\&tab=(.*)/,`&tab=${o}`))})),e(document).on("click","#vwwvpl-sample-waveform .play-button",(function(t){e(this).parent().toggleClass("playing"),l.toggle()})),e(document).on("paused","#vwwvpl-sample-waveform",(function(t){e(this).removeClass("playing")})),e(document).on("playing","#vwwvpl-sample-waveform",(function(t){e(this).addClass("playing")})),e(document).on("click","#vwwaveplayer_default_thumbnail",(function(t){t.preventDefault(),s||(s=wp.media({title:"Select or Upload the default thumbnail",button:{text:"Use this image"},library:{type:"image"},multiple:!1})).on("select",(function(){var t=s.state().get("selection").first().toJSON();e("#vwwaveplayer_default_thumbnail").css({backgroundImage:"url("+t.url+")"}),e("input[name=vwwaveplayer_default_thumbnail]").val(t.url)})),s.open()})),e(document).on("click",".vwwaveplayer-thumbnail-remove",(t=>{t.preventDefault(),t.stopPropagation(),e("#vwwaveplayer_default_thumbnail").css({backgroundImage:""}),e("input[name=vwwaveplayer_default_thumbnail]").val("")})),e(document).on("change","select[name=vwwaveplayer_wave_mode]",(function(){e("#vwwaveplayer_gap_width_group").toggleClass("vwwvpl-inactive",0==e(this).val())})),e(document).on("change","select[name=vwwaveplayer_wave_animation]",(function(){e("#vwwaveplayer_amp_freq_ratio_group").toggleClass("vwwvpl-inactive",1==e(this).val()),d()})),e(document).on("change","select[name=vwwaveplayer_amp_freq_ratio]",(function(){d()}));e(document).on("click",".wvpl_clear_cache",(function(t){t.preventDefault();var a=e(this);const o={mode:e(this).attr("data-elements"),nonce:l.vars.admin_tools_nonce};l.ajaxCall("clear_cache",o).then((t=>{var l=t.success?"notice updated is-dismissible":"notice error is-dismissible";a.parent().append(e("<div>",{class:l}).html(e("<p>").html(t.data.message))),setTimeout((()=>a.parent().find(".notice").each(((t,a)=>e(a).slideUp((()=>a.remove()))))),5e3)}))})),e(document).on("click",".wvpl_delete_peaks",(function(t){t.preventDefault();var a=e(this);const o={mode:e(this).attr("data-elements"),nonce:l.vars.admin_tools_nonce};l.ajaxCall("delete_peaks",o).then((t=>{var l=t.success?"notice updated is-dismissible":"notice error is-dismissible";a.parent().append(e("<div>",{class:l}).html(e("<p>").html(t.data.message)))}))}));var c=[];function p(t,a,o){if(t<c.length&&c.length>0){e(".wvpl_regenerate_peak_progress").val(t);var r=e("input[name=vwwaveplayer_overwrite_peak_files]").prop("checked");const n=c[t];if(!n.hasPeakFile||r){const i=Date.now(),s=n.file_url,d=n.post_title,u=n.meta.length;l.getAudioData(s,n.ID,((t,a)=>{a>0&&e(".wvpl_regenerate_file_progress").val(t/a)})).then((s=>{l.decodeAudioData(s,(s=>{const v=l.extractPeaks(s),m={nonce:l.vars.admin_tools_nonce,overwrite:r,peaks:v.join(",").replace(/0\./gi,"."),id:n.ID};l.ajaxCall("write_peaks",m).then((r=>{if(r.success){u&&(o-=u);const l=Date.now(),r=(l-i)/1e3,n=u/r,s=o/n,v=new Date(Date.now()+Math.round(1e3*s));e("#wvpl_regenerate_peak_notice").empty().append(e("<div>",{class:"notice updated is-dismissible"}).html(e("<p>").append(e("<span>").html(`${t+1} done, ${c.length-t-1} files to go`),e("<br>"),e("<span>").html(`Peak file for “<strong>${d}</strong>” was successfully regenerated in ${Math.round(100*r)/100} seconds (<strong>${Math.round(100*n/60)/100} min/s</strong>)`),e("<br>"),e("<span>").html(`Estimated completion in <strong>${Math.round(s)}</strong> seconds (${v.toLocaleTimeString()})`)))),p(++t,a+(l-i)/1e3,o)}else l.log(r.data.message)}))}))}))}else p(++t,a)}else e("#wvpl_regenerate_peak_notice").empty().append(e("<div>",{class:"notice updated is-dismissible"}).html(e("<p>").append(c.length>0?e("<span>").html("<strong>"+c.length+" peak files</strong> were successfully regenerated in <strong>"+(Math.round(100*a)/100).toString(10)+"</strong> seconds"):e("<span>").html("No tracks needed to be regenerated.")))),e(".wvpl_regenerate_file_progress").hide(),e(".wvpl_regenerate_peak_progress").hide(),e("input.wvpl_regenerate_peaks").prop("disabled",!1),e("input[name=vwwaveplayer_overwrite_peak_files]").prop("disabled",!1),e("input[name=vwwaveplayer_overwrite_peak_files]").prop("checked",!1)}e(document).on("click",".wvpl_regenerate_peaks",(function(a){a.preventDefault(),e("input.wvpl_regenerate_peaks").prop("disabled",!0),e("input[name=vwwaveplayer_overwrite_peak_files]").prop("disabled",!0);const o={all:!0,overwrite:e("input[name=vwwaveplayer_overwrite_peak_files]").prop("checked"),nonce:l.vars.admin_tools_nonce};l.ajaxCall("get_audio_attachments",o).then((a=>{if(a.success){var l=(c=Object.values(a.data.audioFiles)).reduce(((e,t)=>Number(t.meta.length?t.meta.length:0)+e),0);e(".wvpl_regenerate_file_progress").val(0).show(),e(".wvpl_regenerate_peak_progress").val(1).prop("max",c.length).show(),e("#wvpl_regenerate_peak_notice").empty().append(e("<div>",{class:"notice updated is-dismissible"}).html(e("<p>").append(e("<span>").html(t("<strong>%s</strong> ready for peak generation","vwwaveplayer").replace("%s",c.length))))),p(0,0,l)}}))}));var d=function(t){e("#vwwaveplayer-waveform .vwwaveplayer").vwwaveplayer("refresh")};e(document).on("click","#vwwaveplayer_form",(function(t){e(t.target).is([".color-swatch","#color-picker-value","#color-picker-container","#color-picker",".iro__wheel",".iro__wheel__lightness",".iro__slider",".iro__slider__value"].join(","))||e("#color-picker-container").removeClass("active")})),e(document).on("click","#vwwaveplayer_form .color-swatch",(function(){const t=e("#color-picker-container").width(),a=e(this).position().left-t/2,l=e(this).position().top+e(this).height()+10;let r,n;if(a+t/2>document.body.clientWidth&&(a=document.body.clientWidth-t),e("#color-picker-container").css({left:a,top:l}).addClass("active"),e(".color-swatch").removeClass("current"),e(this).addClass("current"),e(this).hasClass("palette-swatch")){const t=e(this).index(),a=e("#palette").attr("data-colors").split("-");r=new iro.Color(`#${a[t]}`),n=v(r.hexString)}else r=new iro.Color(e(this).css("background-color")),n=v(r.hex8String);e("#color-picker-value").val(n).select().focus(),o.color.hex8String=r.hex8String})),e(document).on("input","#color-picker-value",(t=>{if(!u(e(t.target).val()))return!1;const a=v(e(t.target).val());if(e(".color-swatch.current").data("name")){const t=e(".color-swatch.current").data("name").replace("vwwaveplayer_","");e(`#vwwaveplayer_${t}`).val(a),vwwvplVars.options[t]=a,e(".color-swatch.current").css("background-color",a),o.color.hexString=a.hexString,d()}else{const t=e(".color-swatch.current").index(),l=e("#palette").attr("data-colors").split("-"),r=new iro.Color(a);l[t]=r.hexString.replace("#",""),e(".color-swatch.current").data("color",Object.values(r.rgb).join(",")).data("hue",r.hsl.h),o.color.hexString=r.hexString,i(l)}})),e(document).on("input",'#vwwaveplayer-waveform :input[name^="vwwaveplayer"]',(function(){const e=this.name.replace("vwwaveplayer_","");vwwvplVars.options[e]=this.value,d()})),e(document).on("change blur","input.vwwaveplayer-color-input",(function(t){let a=e(`.color-swatch[data-name=${e("#color-picker-container").data("name")}]`),l=e("#color-picker").val();if(u(l))a.css("background-color",l),d();else{let t=new iro.Color(a.css("background-color"));e("#color-picker").val(v(t.hex8String))}}));const u=e=>!!e.match(/^#[\da-f]{8}$|^#[\da-f]{6}$|^#[\da-f]{4}$|^#[\da-f]{3}$/i),v=e=>{let t;return(t=e.match(/^#([\da-f]{3})f$/i))&&(e=`#${t[1]}`),(t=e.match(/^#([\da-f]{6})ff$/i))&&(e=`#${t[1]}`),(t=e.match(/^#([\da-f])\1([\da-f])\2([\da-f])\3$/i))&&(e=`#${t[1]}${t[2]}${t[3]}`),(t=e.match(/^#([\da-f])\1([\da-f])\2([\da-f])\3([\da-f])\4$/i))&&(e=`#${t[1]}${t[2]}${t[3]}${t[4]}`),e};e(document).on("click",".wvpl_toggle_selection",(function(t){t.preventDefault();var a="select"==e(this).data("mode"),l=e(this).data("type");e("#vwwaveplayer_music_"+l+" input:enabled").each((function(t,l){e(l).prop("checked",a)}))})),e(document).on("keyup keypress","#vwwaveplayer-woocommerce #track-search-input",(function(e){if(13===e.keyCode)return e.preventDefault(),m(1,e.target.value),!1})),e(document).on("keyup keypress","#track-pagination #current-page-selector",(function(e){if(13===e.keyCode)return e.preventDefault(),m(e.target.value),!1})),e(document).on("click","#track-pagination .pagination-links a",(function(e){e.preventDefault();let t=1;const a=e.currentTarget.href.match(/paged=(\d+)/);a&&a[1]&&(t=a[1]),m(t)}));const m=(t=1,a="")=>{const o={paged:t,search:a,nonce:l.vars.admin_tools_nonce};l.ajaxCall("music_inputs",o).then((t=>{if(t.success){const a=t.data.track_inputs,l=t.data.paginate_links;e("#vwwaveplayer-woocommerce #track-pagination").html(l),e("#vwwaveplayer-woocommerce #vwwaveplayer_music_tracks").html(a)}else l.log(t.data.message)}))};e(document).on("click",".wvpl_create_products",(function(t){t.preventDefault();var a=e(this).data("type"),o=0,r=e("#vwwaveplayer_music_"+a+" input:checked").length,n=e(".wvpl_products_progress_"+a);n.val(o).prop("max",r).show(),e("#vwwaveplayer_music_"+a+" input:checked").each((function(t,i){const s={type:a,product_type:e("#vwwaveplayer_woocommerce_product_type").val(),id:e(i).val(),price:e("#vwwaveplayer_woocommerce_price_"+a).val(),tracks:e(i).data("tracks"),title:e(i).data("title"),nonce:vwwvplVars.admin_tools_nonce};l.ajaxCall("create_product",s).then((t=>{o++,n.val(o),e(i).prop("checked",!1).prop("disabled",!0).next().toggleClass("disabled",!0),o==r&&n.parent().append(e("<div>",{class:"notice updated is-dismissible"}).html(e("<p>").html(r+" products successfully created")))}))}))})),e(document).on("click","table.vwwaveplayer-custom-fields .row-actions button.editinline",(t=>{t.preventDefault();const a=e(t.target).closest("tr"),l=a.find("input.field-name").val(),o=a.find("input.field-label").val(),r=a.find("input.field-type").val(),n=a.find("input.field-default").val(),i=a.find("input.field-options").val();a.addClass("updating"),e("#custom_field_editor").find("#field_name").val(l),e("#custom_field_editor").find("#field_label").val(o),e("#custom_field_editor").find("#field_type").val(r),e("#custom_field_editor").find("#field_default").val(n),e("#custom_field_editor").find("#field_options").prop("disabled",!["select","radio"].includes(r)).val(i),e("#custom_field_editor").insertAfter(a),e(t.target).closest("table").find("tr#custom_field_editor").removeClass("hidden").data("cf-name",l)})),e(document).on("click","table.vwwaveplayer-custom-fields .row-actions .trash a",(t=>{t.preventDefault();const a=e(t.target).closest("tr"),l=a.find(".field-name").val();a&&a.remove();const o=e("#custom_field_names").val().split(",").filter((e=>e&&e!==l)).join(",");e("#custom_field_names").val(o)})),e(document).on("click","table.vwwaveplayer-custom-fields button#add-custom-field",(t=>{t.preventDefault(),_(),e("#custom_field_editor").removeClass("hidden").data("cf-name",0).insertAfter(e("table.vwwaveplayer-custom-fields tr.custom-field-row").last())})),e(document).on("keypress","table.vwwaveplayer-custom-fields :input",(t=>{if(13===t.which){t.preventDefault();e(t.target).closest("tr").find("button#update-custom-field").click()}})),e(document).on("change","table.vwwaveplayer-custom-fields :input",(t=>{t.preventDefault(),e(t.target).closest("td").find("label").removeClass("form-invalid"),e(t.target).closest("td").find(".notice").remove(),"field_label"!==t.target.id||e("table.vwwaveplayer-custom-fields input#field_name").val()||e("table.vwwaveplayer-custom-fields input#field_name").val(e(t.target).val().toLowerCase().replace(/[ -]/g,"_").replace(/[^a-z0-9_]/g,""))})),e(document).on("click","table.vwwaveplayer-custom-fields button#cancel-custom-field",(e=>{_()})),e(document).on("click","table.vwwaveplayer-custom-fields button#update-custom-field",(a=>{a.preventDefault();const l=e("#custom_field_editor"),o=e("table.vwwaveplayer-custom-fields tr.updating"),r=e("#custom_field_names").val()?e("#custom_field_names").val().split(","):[],n=e("input#field_name").val(),i=e("select#field_type").val(),s=e("input#field_default").val();if(l.find(".notice").remove(),!e("input#field_name").val())return e("input#field_name").closest("label").addClass("form-invalid"),void e(a.target).closest("label").after(e("<div>",{class:"notice notice-error"}).append(e("<p>").text(t("The field name must be a valid identifier.","vwwaveplayer"))));if(o&&n!==o.data("name")&&r.includes(n))return e("input#field_name").closest("label").addClass("form-invalid"),void e(a.target).closest("label").after(e("<div>",{class:"notice notice-error"}).append(e("<p>").text(t("Field names must be unique. A field with this name is already present.","vwwaveplayer"))));let c,p=l.data("row");const d=["select","radio"].includes(i)?e("input#field_options").val():"";if(["select","radio"].includes(i)&&d.split(",").reduce(((e,t)=>e+Number(t.length>0)),0)<=1)return e("input#field_options").closest("label").addClass("form-invalid"),void e(a.target).closest("label").after(e("<div>",{class:"notice notice-error"}).append(e("<p>").text(t("The selected type of field must have at least two options. Please type two or more options, separated by commas.","vwwaveplayer"))));let u=`name: <strong>${n}</strong><br/>\n                                   type: <strong>${i}</strong><br/>\n                                   default: <strong>${s}</strong><br/>`;d?(u=u.concat(`<br/>options: ${d}`),c=l.data("options").replace(/%%name%%/gi,n).replace(/%%options%%/gi,d)):c="",p=p.replace(/%%description%%/gi,u).replace(/%%name%%/gi,e("input#field_name").val()).replace(/%%label%%/gi,e("input#field_label").val()).replace(/%%type%%/gi,e("select#field_type").val()).replace(/%%default%%/gi,e("input#field_default").val()).replace(/%%option_input%%/gi,c),r.push(n),o.length?e(p).insertBefore(o):e(p).insertBefore(l),o.remove(),e("#custom_field_names").val(r.join(",")),_()}));const _=function(){e("#custom_field_editor").addClass("hidden"),e("table.vwwaveplayer-custom-fields tr.updating").removeClass("updating"),e("input#field_name").val(""),e("input#field_label").val(""),e("input#field_ldefault").val(""),e("select#field_type").val("text"),e("input#field_options").val("").prop("disabled",!0)};e(document).on("change","table.vwwaveplayer-custom-fields select#field_type",(t=>{t.preventDefault(),e("table.vwwaveplayer-custom-fields input#field_options").prop("disabled",!["select","radio"].includes(e(t.target).val()))})),e(document).on("click",".notice-vwwaveplayer-registration",(e=>{l.ajaxCall("dismiss_registration_notice")})),l.audio.loop=!0})()}))}(jQuery,wp.i18n.__);